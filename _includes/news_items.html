{% comment %} Extract topic from page permalink {% endcomment %}
{% assign topic = page.permalink | remove: '/' | replace: '-', '_' %}
{% assign news_data = null %}

{% comment %} Map topic to corresponding data file {% endcomment %}
{% case topic %}
  {% when 'deep_learning' %}
    {% assign news_data = site.data.news.deep-learning %}
  {% when 'machine_learning' %}
    {% assign news_data = site.data.news.machine-learning %}
  {% when 'artificial_intelligence' %}
    {% assign news_data = site.data.news.artificial-intelligence %}
  {% when 'technology' %}
    {% assign news_data = site.data.news.technology %}
  {% when 'science' %}
    {% assign news_data = site.data.news.science %}
  {% when 'business' %}
    {% assign news_data = site.data.news.business %}
  {% when 'health' %}
    {% assign news_data = site.data.news.health %}
{% endcase %}

{% if news_data and news_data.news_items %}
  {% assign sorted_news = news_data.news_items | sort: "date" | reverse %}
  <div class="news-container">
    {% for item in sorted_news %}
      <div class="news-item" style="margin-bottom: 20px; padding: 15px; background-color: var(--card-background-color); border-radius: 8px; border-left: 4px solid var(--link-color);">
        <h4 style="margin-top: 0; margin-bottom: 10px;">
          <strong>{{ item.title | escape }}</strong>
        </h4>
        <p style="margin-bottom: 10px; color: var(--main-text-color);">
          {{ item.description | escape }}
        </p>
        <a href="{{ item.url }}" target="_blank" rel="noopener noreferrer" style="color: var(--link-color); text-decoration: none;">
          Read more â†’
        </a>
        {% if item.source %}
          <span style="color: var(--main-text-color); opacity: 0.7; font-size: 0.9em; margin-left: 10px;">
            | {{ item.source | escape }}
          </span>
        {% endif %}
        {% if item.date %}
          <span style="color: var(--main-text-color); opacity: 0.7; font-size: 0.9em; margin-left: 10px;">
            {% comment %} Format date - Jekyll date filter handles YYYY-MM-DD format {% endcomment %}
            {% assign formatted_date = item.date | date: "%B %d, %Y" %}
            {% if formatted_date != item.date %}
              ({{ formatted_date }})
            {% else %}
              ({{ item.date }})
            {% endif %}
          </span>
        {% endif %}
      </div>
    {% endfor %}
  </div>
  <p style="margin-top: 20px; font-style: italic; color: var(--main-text-color); opacity: 0.7;">
    <em>Last updated: <span id="philippines-time"></span></em>
  </p>
  <script>
    // Display time in Philippines timezone (PHT - UTC+8)
    function updatePhilippinesTime() {
      const options = { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric', 
        hour: 'numeric', 
        minute: '2-digit',
        hour12: true,
        timeZone: 'Asia/Manila'
      };
      const formatted = new Date().toLocaleString('en-US', options);
      document.getElementById('philippines-time').textContent = formatted;
    }
    updatePhilippinesTime();
    // Update every minute
    setInterval(updatePhilippinesTime, 60000);
  </script>
{% else %}
  <p>No news items available at this time. Please check back later.</p>
{% endif %}

