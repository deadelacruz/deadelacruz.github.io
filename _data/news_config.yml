# News Configuration
# This file contains all configuration for news fetching including topics, keywords, and settings

# API Configuration
api:
  base_url: "https://newsapi.org/v2/everything"
  timeout_seconds: 15
  max_page_size: 100  # NewsAPI maximum
  max_pages: 10  # Maximum number of pages per topic (fallback limit, early stopping will usually stop before this)
  language: "en"
  sort_by: "publishedAt"
  rate_limit_delay_seconds: 1.0  # Delay between API calls to respect rate limits
  topic_delay_seconds: 2.0  # Delay between topics to prevent hitting rate limits
  max_api_calls: 45  # Maximum API calls per run (safety buffer under 50 limit per 12 hours)
  max_retries: 3  # Maximum retries for rate limit errors (429)
  retry_base_delay_seconds: 60  # Base delay for exponential backoff retries (1 minute)
  
  # Early Stopping Optimization (NEW - Reduces API calls significantly)
  # Stop pagination early when we have enough articles or too many duplicates
  min_articles_per_topic: 10  # Stop pagination when we have this many new articles per topic
  early_stop_duplicate_threshold: 0.7  # Stop if 70%+ of articles on a page are duplicates (0.0-1.0)

# Date Range Configuration
date_range:
  lookback_days: 30  # How many days back to search from NewsAPI (MAXIMUM for free tier - cannot go higher!)
  exclude_today: true  # Exclude today due to NewsAPI free tier 24-hour delay
  exclude_today_offset_days: 1  # Days to exclude from today
  retention_days: 90  # How many days to keep articles in UI (increased to build cache over time)
  # NOTE: NewsAPI free tier only allows articles up to 30 days old
  # To get older articles, you need a paid plan ($449+/month)
  # This script can only fetch last 30 days, but we keep them for 90 days in cache

# Article Processing Configuration
article_processing:
  max_description_length: 250  # Maximum characters for article description
  max_title_preview_length: 60  # Maximum characters for title preview in logs
  max_error_text_length: 500  # Maximum characters for error text in logs
  debug_log_filtered_limit: 3  # Only log first N filtered articles to avoid spam

# Metrics Configuration
metrics:
  export_to_json: true  # Export metrics to JSON file
  json_output_path: "_data/news_metrics.json"  # Path for metrics JSON export

# UI Display Configuration
ui:
  articles_per_page: 20  # Number of articles to show per page (default: 20)
  enable_pagination: true  # Enable pagination (true) or show all articles (false)
  show_all_option: true  # Show "Show All" button to display all articles at once

# News Sources Configuration
# Each topic searches for exact phrase only (case-insensitive)
# - "Deep Learning" or "deep learning" only
# - "Machine Learning" or "machine learning" only  
# - "Artificial Intelligence" or "artificial intelligence" only
#
# Optimization Settings:
# - priority: Lower number = higher priority (processed first). If rate limit hits, high-priority topics are guaranteed.
# - max_pages: Optional override for this topic (defaults to api.max_pages)
#
# Expected API calls with early stopping: 3 topics Ã— 2-3 pages = 6-9 calls (vs 30 without optimization)
# This leaves plenty of buffer under the 50 requests per 12 hours limit
news_sources:
  deep-learning:
    name: "Deep Learning"
    title_query: "Deep Learning"  # Exact phrase only: "Deep Learning" or "deep learning"
    priority: 1  # Highest priority - processed first
    # max_pages: 5  # Optional: override global limit for this topic
  
  machine-learning:
    name: "Machine Learning"
    title_query: "Machine Learning"  # Exact phrase only: "Machine Learning" or "machine learning"
    priority: 2  # Medium priority
  
  artificial-intelligence:
    name: "Artificial Intelligence"
    title_query: "Artificial Intelligence"  # Exact phrase only: "Artificial Intelligence" or "artificial intelligence"
    priority: 3  # Lower priority (will be skipped if quota runs low)

